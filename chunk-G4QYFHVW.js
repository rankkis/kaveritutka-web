import{a as Ye,b as Ze}from"./chunk-DQ4HH7ZF.js";import{a as Qe,c as Xe,e as et,f as tt,g as it}from"./chunk-S6UGR7ZJ.js";import{a as A,b as L}from"./chunk-W3DY4WBV.js";import{a as Je}from"./chunk-F7OEFYQI.js";import"./chunk-X5YLR3NI.js";import{A as T,B as V,C as ie,D as ne,E as ae,F as Be,G as je,H as Ge,I as ce,J as He,K as Ke,L as We,M as $e,N as Ue,a as Te,c as k,f as Ve,h as D,i as v,j as w,k as $,l as Ne,m as U,n as Y,o as Z,p as J,q as Q,r as ze,s as X,t as I,u as ee,v as te,w as Ae,x as Le,y as F,z as R}from"./chunk-VAUPV3VO.js";import{a as B,b as j,c as Re,d as G,e as H,f as K,g as W}from"./chunk-JNMHGGBV.js";import"./chunk-4RZRIDW5.js";import{o as q,p as S}from"./chunk-YHC27YZP.js";import"./chunk-JT74BPEB.js";import{Q as Fe,Z as xe,e as O,f as E,i as P,t as Ie}from"./chunk-HQI5KKRE.js";import{$ as ke,$b as we,Bb as l,Db as be,I as M,Jb as n,Kb as i,Lb as y,Pb as b,Rb as g,Sb as p,ab as s,ac as r,bc as Ce,cc as u,dc as z,ec as le,fb as f,fc as me,gc as de,ma as _,mb as x,na as h,nb as De,sb as c,xa as N}from"./chunk-2ZS5FXWY.js";import"./chunk-ODN5LVDJ.js";var nt=(()=>{class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=De({type:a});static \u0275inj=ke({imports:[Fe,xe,xe]})}return a})();function lt(a,o){a&1&&(n(0,"mat-chip",14),r(1," Ratkaistu "),i())}function mt(a,o){a&1&&(n(0,"mat-chip",15),r(1," Aktiivinen "),i())}function dt(a,o){if(a&1&&(n(0,"mat-chip",18),r(1),i()),a&2){let e=o.$implicit;s(),u(" ",e," ")}}function ct(a,o){if(a&1&&(n(0,"div",16)(1,"mat-chip-set"),c(2,dt,2,1,"mat-chip",17),i()()),a&2){let e=p();s(2),l("ngForOf",e.request.interests)}}function pt(a,o){if(a&1){let e=b();n(0,"a",19),g("click",function(){_(e);let m=p();return h(m.toggleDescription())}),r(1),i()}if(a&2){let e=p();s(),u(" ",e.showFullDescription?"N\xE4yt\xE4 v\xE4hemm\xE4n":"Lue lis\xE4\xE4"," ")}}function ut(a,o){if(a&1){let e=b();n(0,"div",20)(1,"button",21),g("click",function(){_(e);let m=p();return h(m.onSendMessage())}),n(2,"mat-icon"),r(3,"mail"),i(),r(4," L\xE4het\xE4 viesti "),i(),n(5,"button",22),g("click",function(){_(e);let m=p();return h(m.onProposePlaytime())}),n(6,"mat-icon"),r(7,"event"),i(),r(8," Ehdota leikkiaikaa "),i()()}}function gt(a,o){if(a&1){let e=b();n(0,"button",26),g("click",function(){_(e);let m=p(2);return h(m.onEdit())}),n(1,"mat-icon"),r(2,"edit"),i(),r(3," Muokkaa "),i()}}function ft(a,o){if(a&1){let e=b();n(0,"div",23),c(1,gt,4,0,"button",24),n(2,"button",25),g("click",function(){_(e);let m=p();return h(m.onDelete())}),n(3,"mat-icon"),r(4,"delete"),i(),r(5," Poista "),i()()}if(a&2){let e=p();s(),l("ngIf",e.request.status==="active")}}var pe=class a{request;isOwner=!1;sendMessage=new N;proposePlaytime=new N;edit=new N;delete=new N;close=new N;showFullDescription=!1;get isLongDescription(){return this.request.description.length>150}get displayDescription(){return this.showFullDescription||!this.isLongDescription?this.request.description:this.request.description.substring(0,150)+"..."}toggleDescription(){this.showFullDescription=!this.showFullDescription}onSendMessage(){this.sendMessage.emit(this.request)}onProposePlaytime(){this.proposePlaytime.emit(this.request)}onEdit(){this.edit.emit(this.request)}onDelete(){confirm("Haluatko varmasti poistaa t\xE4m\xE4n ilmoituksen?")&&this.delete.emit(this.request)}onClose(){confirm("Haluatko merkit\xE4 ilmoituksen ratkaistuksi?")&&this.close.emit(this.request)}getRelativeTime(){let o=new Date,e=new Date(this.request.createdAt),t=o.getTime()-e.getTime(),m=Math.floor(t/6e4),d=Math.floor(m/60),C=Math.floor(d/24);return m<60?`${m} minuuttia sitten`:d<24?`${d} tuntia sitten`:C<7?`${C} p\xE4iv\xE4\xE4 sitten`:e.toLocaleDateString("fi-FI")}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=x({type:a,selectors:[["app-friend-request-card"]],inputs:{request:"request",isOwner:"isOwner"},outputs:{sendMessage:"sendMessage",proposePlaytime:"proposePlaytime",edit:"edit",delete:"delete",close:"close"},decls:28,vars:14,consts:[[1,"friend-request-card"],[1,"card-header-content"],[1,"child-info"],[1,"child-name"],[1,"parent-name"],["class","status-chip closed",4,"ngIf"],["class","status-chip active",4,"ngIf"],["class","interests-section",4,"ngIf"],[1,"description"],["class","read-more-link",3,"click",4,"ngIf"],[1,"location"],[1,"created-date"],["class","public-actions",4,"ngIf"],["class","owner-actions",4,"ngIf"],[1,"status-chip","closed"],[1,"status-chip","active"],[1,"interests-section"],["class","interest-chip",4,"ngFor","ngForOf"],[1,"interest-chip"],[1,"read-more-link",3,"click"],[1,"public-actions"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"owner-actions"],["mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","",3,"click"]],template:function(e,t){e&1&&(n(0,"mat-card",0)(1,"mat-card-header")(2,"div",1)(3,"div",2)(4,"h3",3),r(5),i(),n(6,"span",4),r(7),i()(),c(8,lt,2,0,"mat-chip",5)(9,mt,2,0,"mat-chip",6),i()(),n(10,"mat-card-content"),c(11,ct,3,1,"div",7),n(12,"p",8),r(13),c(14,pt,2,1,"a",9),i(),n(15,"div",10)(16,"mat-icon"),r(17,"location_on"),i(),n(18,"span"),r(19),i()(),n(20,"div",11)(21,"mat-icon"),r(22,"schedule"),i(),n(23,"span"),r(24),i()()(),n(25,"mat-card-actions"),c(26,ut,9,0,"div",12)(27,ft,6,1,"div",13),i()()),e&2&&(be("closed",t.request.status==="closed"),s(5),z("",t.request.childName,", ",t.request.childAge," v"),s(2),u("Vanhempi: ",t.request.parentName,""),s(),l("ngIf",t.request.status==="closed"),s(),l("ngIf",t.request.status==="active"),s(2),l("ngIf",t.request.interests&&t.request.interests.length>0),s(2),u(" ",t.displayDescription," "),s(),l("ngIf",t.isLongDescription),s(5),Ce(t.request.city),s(5),Ce(t.getRelativeTime()),s(2),l("ngIf",!t.isOwner&&t.request.status==="active"),s(),l("ngIf",t.isOwner))},dependencies:[P,O,E,it,Qe,et,Xe,tt,S,q,L,A,ce,Be,Ge,nt],styles:[".friend-listing-card[_ngcontent-%COMP%]{margin-bottom:16px;transition:all .3s ease}.friend-listing-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.friend-listing-card.closed[_ngcontent-%COMP%]{opacity:.7;background-color:#f5f5f5}.card-header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;width:100%;gap:16px}.child-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;flex:1}.child-info[_ngcontent-%COMP%]   .child-name[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#673ab7}.child-info[_ngcontent-%COMP%]   .parent-name[_ngcontent-%COMP%]{font-size:14px;color:#0009}.status-chip.active[_ngcontent-%COMP%]{background-color:#4caf50!important;color:#fff!important}.status-chip.closed[_ngcontent-%COMP%]{background-color:#9e9e9e!important;color:#fff!important}mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding-top:16px}.interests-section[_ngcontent-%COMP%]   mat-chip-set[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.interests-section[_ngcontent-%COMP%]   .interest-chip[_ngcontent-%COMP%]{background-color:#673ab71a;color:#673ab7;font-size:12px}.description[_ngcontent-%COMP%]{margin:0;line-height:1.6;color:#000000de;white-space:pre-wrap;word-wrap:break-word}.description[_ngcontent-%COMP%]   .read-more-link[_ngcontent-%COMP%]{color:#673ab7;cursor:pointer;text-decoration:none;margin-left:4px;font-weight:500}.description[_ngcontent-%COMP%]   .read-more-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.location[_ngcontent-%COMP%], .created-date[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;color:#0009}.location[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .created-date[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#673ab7}mat-card-actions[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:flex-end}mat-card-actions[_ngcontent-%COMP%]   .public-actions[_ngcontent-%COMP%], mat-card-actions[_ngcontent-%COMP%]   .owner-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;width:100%}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:0}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px;font-size:18px;width:18px;height:18px}@media (max-width: 768px){.card-header-content[_ngcontent-%COMP%]{flex-direction:column}mat-card-actions[_ngcontent-%COMP%]   .public-actions[_ngcontent-%COMP%], mat-card-actions[_ngcontent-%COMP%]   .owner-actions[_ngcontent-%COMP%]{width:100%;flex-direction:column}mat-card-actions[_ngcontent-%COMP%]   .public-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], mat-card-actions[_ngcontent-%COMP%]   .owner-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;flex:none}}"]})};function _t(a,o){a&1&&(n(0,"mat-error"),r(1," Lapsen nimi on pakollinen "),i())}function ht(a,o){a&1&&(n(0,"mat-error"),r(1," Nimi voi olla enint\xE4\xE4n 255 merkki\xE4 "),i())}function vt(a,o){if(a&1&&(n(0,"mat-option",17),r(1),i()),a&2){let e=o.$implicit;l("value",e),s(),u(" ",e," vuotta ")}}function bt(a,o){a&1&&(n(0,"mat-error"),r(1," Valitse lapsen ik\xE4 "),i())}function Ct(a,o){if(a&1){let e=b();n(0,"mat-chip-option",18),g("click",function(){let m=_(e).$implicit,d=p();return h(d.toggleInterest(m))}),r(1),i()}if(a&2){let e=o.$implicit,t=p();l("selected",t.isInterestSelected(e)),s(),u(" ",e," ")}}function xt(a,o){a&1&&(n(0,"div",19),r(1," Valitse v\xE4hint\xE4\xE4n yksi kiinnostuksen kohde "),i())}function Mt(a,o){a&1&&(n(0,"mat-error"),r(1," Kuvaus on pakollinen "),i())}function yt(a,o){a&1&&(n(0,"mat-error"),r(1," Kuvaus voi olla enint\xE4\xE4n 500 merkki\xE4 "),i())}var _e=class a{constructor(o,e,t,m){this.fb=o;this.friendRequestService=e;this.dialogRef=t;this.data=m}form;isSubmitting=!1;availableInterests=["Jalkapallo","Keinut","Liukum\xE4et","Hiekkalaatikko","Kiipeily","Juokseminen","Py\xF6r\xE4ily","Pallopelit","Piirt\xE4minen","Ulkoilu","El\xE4imet"];selectedInterests=[];ageOptions=[0,1,2,3,4,5,6,7];ngOnInit(){this.form=this.fb.group({childName:["",[v.required,v.maxLength(255)]],childAge:["",[v.required]],description:["",[v.required,v.maxLength(500)]]})}toggleInterest(o){let e=this.selectedInterests.indexOf(o);e>=0?this.selectedInterests.splice(e,1):this.selectedInterests.push(o)}isInterestSelected(o){return this.selectedInterests.includes(o)}onSubmit(){if(this.form.invalid||this.selectedInterests.length===0||this.isSubmitting)return;this.isSubmitting=!0;let o={parentName:"Vanhempi",childName:this.form.value.childName,childAge:this.form.value.childAge,description:this.form.value.description,interests:this.selectedInterests,latitude:this.data.latitude,longitude:this.data.longitude,city:this.data.city};console.log("Creating friend request with DTO:",o),this.friendRequestService.createFriendRequest(o).pipe(M(1)).subscribe({next:e=>{console.log("Friend request created successfully:",e),this.dialogRef.close(e)},error:e=>{console.error("Error creating friend request:",e),console.error("Error details:",e.error);let t="Kaverihakuilmoituksen luominen ep\xE4onnistui.";e.status===401?t="Kirjaudu sis\xE4\xE4n luodaksesi ilmoituksen.":e.error?.message&&(t=e.error.message),alert(t+" Yrit\xE4 uudelleen."),this.isSubmitting=!1}})}onCancel(){this.dialogRef.close()}get remainingChars(){return 500-(this.form.get("description")?.value||"").length}static \u0275fac=function(e){return new(e||a)(f(Q),f(k),f(B),f(j))};static \u0275cmp=x({type:a,selectors:[["app-friend-request-create-dialog"]],decls:40,vars:14,consts:[["mat-dialog-title",""],[1,"friend-request-form",3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","childName","placeholder","Esim. Emma","required",""],[4,"ngIf"],["formControlName","childAge","required",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-section"],[1,"section-label"],[1,"interests-chips"],["class","interest-chip",3,"selected","click",4,"ngFor","ngForOf"],["class","hint","style","color: #f44336; font-size: 12px; margin-top: 4px;",4,"ngIf"],["matInput","","formControlName","description","rows","6","placeholder","Kerro lapsestasi ja mit\xE4 etsitte. Esim. erityistarpeet, toiveet leikkikaverin suhteen...","required",""],["align","end"],[1,"location-info"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],[3,"value"],[1,"interest-chip",3,"click","selected"],[1,"hint",2,"color","#f44336","font-size","12px","margin-top","4px"]],template:function(e,t){if(e&1&&(n(0,"h2",0),r(1,"Luo kaverihakuilmoitus"),i(),n(2,"mat-dialog-content")(3,"form",1)(4,"mat-form-field",2)(5,"mat-label"),r(6,"Lapsen nimi"),i(),y(7,"input",3),c(8,_t,2,0,"mat-error",4)(9,ht,2,0,"mat-error",4),i(),n(10,"mat-form-field",2)(11,"mat-label"),r(12,"Lapsen ik\xE4"),i(),n(13,"mat-select",5),c(14,vt,2,2,"mat-option",6),i(),c(15,bt,2,0,"mat-error",4),i(),n(16,"div",7)(17,"label",8),r(18,"Kiinnostuksen kohteet *"),i(),n(19,"div",9),c(20,Ct,2,2,"mat-chip-option",10),i(),c(21,xt,2,0,"div",11),i(),n(22,"mat-form-field",2)(23,"mat-label"),r(24,"Kuvaus"),i(),y(25,"textarea",12),n(26,"mat-hint",13),r(27),i(),c(28,Mt,2,0,"mat-error",4)(29,yt,2,0,"mat-error",4),i(),n(30,"div",14)(31,"mat-icon"),r(32,"location_on"),i(),n(33,"span"),r(34),i()()()(),n(35,"mat-dialog-actions",13)(36,"button",15),g("click",function(){return t.onCancel()}),r(37," Peruuta "),i(),n(38,"button",16),g("click",function(){return t.onSubmit()}),r(39),i()()),e&2){let m,d,C,oe,re;s(3),l("formGroup",t.form),s(5),l("ngIf",(m=t.form.get("childName"))==null?null:m.hasError("required")),s(),l("ngIf",(d=t.form.get("childName"))==null?null:d.hasError("maxlength")),s(5),l("ngForOf",t.ageOptions),s(),l("ngIf",(C=t.form.get("childAge"))==null?null:C.hasError("required")),s(5),l("ngForOf",t.availableInterests),s(),l("ngIf",t.selectedInterests.length===0),s(6),u("",t.remainingChars," / 500 merkki\xE4 j\xE4ljell\xE4"),s(),l("ngIf",(oe=t.form.get("description"))==null?null:oe.hasError("required")),s(),l("ngIf",(re=t.form.get("description"))==null?null:re.hasError("maxlength")),s(5),u("Sijainti: ",t.data.city,""),s(2),l("disabled",t.isSubmitting),s(2),l("disabled",t.form.invalid||t.selectedInterests.length===0||t.isSubmitting),s(),u(" ",t.isSubmitting?"Luodaan...":"Luo ilmoitus"," ")}},dependencies:[P,O,E,X,U,D,w,$,J,Y,Z,W,G,K,H,S,q,R,F,I,te,ee,V,T,ae,ne,ie,ce,je,L,A],styles:[".friend-listing-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;min-width:400px;padding:16px 0}@media (max-width: 768px){.friend-listing-form[_ngcontent-%COMP%]{min-width:280px}}.full-width[_ngcontent-%COMP%]{width:100%}.form-section[_ngcontent-%COMP%]{margin-bottom:16px}.form-section[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#000000de;margin-bottom:12px}.interests-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.interests-chips[_ngcontent-%COMP%]   .interest-chip[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.interests-chips[_ngcontent-%COMP%]   .interest-chip[_ngcontent-%COMP%]:hover{background-color:#673ab71a}.location-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;background-color:#673ab70d;border-radius:4px;color:#0009}.location-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#673ab7}mat-dialog-content[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px}"]})};function Et(a,o){a&1&&(n(0,"mat-error"),r(1," Viesti on pakollinen "),i())}function Pt(a,o){a&1&&(n(0,"mat-error"),r(1," Viesti voi olla enint\xE4\xE4n 300 merkki\xE4 "),i())}var he=class a{constructor(o,e,t,m){this.fb=o;this.friendRequestService=e;this.dialogRef=t;this.data=m}form;isSubmitting=!1;ngOnInit(){this.form=this.fb.group({message:["",[v.required,v.maxLength(300)]]})}onSubmit(){if(this.form.invalid||this.isSubmitting)return;this.isSubmitting=!0;let o={requestId:this.data.request.id,message:this.form.value.message};this.friendRequestService.sendMessage(o).pipe(M(1)).subscribe({next:()=>{alert("Viesti l\xE4hetetty onnistuneesti! Ilmoituksen luoja saa sen s\xE4hk\xF6postiinsa."),this.dialogRef.close(!0)},error:e=>{console.error("Error sending message:",e),alert("Viestin l\xE4hett\xE4minen ep\xE4onnistui. Yrit\xE4 uudelleen."),this.isSubmitting=!1}})}onCancel(){this.dialogRef.close()}get remainingChars(){return 300-(this.form.get("message")?.value||"").length}static \u0275fac=function(e){return new(e||a)(f(Q),f(k),f(B),f(j))};static \u0275cmp=x({type:a,selectors:[["app-send-message-dialog"]],decls:25,vars:10,consts:[["mat-dialog-title",""],[1,"request-info"],[1,"message-form",3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","message","rows","8","placeholder","Hei! Meill\xE4 on my\xF6s sammanik\xE4inen lapsi. Haluaisitko jutella lis\xE4\xE4 ja sopia yhteisest\xE4 leikkiajasta?","required",""],["align","end"],[4,"ngIf"],[1,"info-box"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(e,t){if(e&1&&(n(0,"h2",0),r(1,"L\xE4het\xE4 viesti"),i(),n(2,"mat-dialog-content")(3,"div",1)(4,"h3"),r(5),i(),n(6,"p"),r(7),i()(),n(8,"form",2)(9,"mat-form-field",3)(10,"mat-label"),r(11,"Viestisi"),i(),y(12,"textarea",4),n(13,"mat-hint",5),r(14),i(),c(15,Et,2,0,"mat-error",6)(16,Pt,2,0,"mat-error",6),i(),n(17,"div",7)(18,"p"),r(19,"\u{1F4A1} Vinkki: Kerro lyhyesti lapsestasi ja miksi otit yhteytt\xE4. Ilmoituksen luoja saa viestisi s\xE4hk\xF6postiinsa."),i()()()(),n(20,"mat-dialog-actions",5)(21,"button",8),g("click",function(){return t.onCancel()}),r(22," Peruuta "),i(),n(23,"button",9),g("click",function(){return t.onSubmit()}),r(24),i()()),e&2){let m,d;s(5),z("",t.data.request.childName,", ",t.data.request.childAge," v"),s(2),u("Vanhempi: ",t.data.request.parentName,""),s(),l("formGroup",t.form),s(6),u("",t.remainingChars," / 300 merkki\xE4 j\xE4ljell\xE4"),s(),l("ngIf",(m=t.form.get("message"))==null?null:m.hasError("required")),s(),l("ngIf",(d=t.form.get("message"))==null?null:d.hasError("maxlength")),s(5),l("disabled",t.isSubmitting),s(2),l("disabled",t.form.invalid||t.isSubmitting),s(),u(" ",t.isSubmitting?"L\xE4hetet\xE4\xE4n...":"L\xE4het\xE4 viesti"," ")}},dependencies:[P,E,X,U,D,w,$,J,Y,Z,W,G,K,H,S,q,R,F,I,te,ee,V,T],styles:[".listing-info[_ngcontent-%COMP%]{background-color:#673ab70d;padding:16px;border-radius:4px;margin-bottom:24px}.listing-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#673ab7;font-size:18px;font-weight:600}.listing-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#0009;font-size:14px}.message-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.full-width[_ngcontent-%COMP%]{width:100%}.info-box[_ngcontent-%COMP%]{background-color:#e8f5e9;border-left:4px solid #4caf50;padding:12px 16px;border-radius:4px}.info-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:1.5;color:#000c}mat-dialog-content[_ngcontent-%COMP%]{min-width:400px;max-height:70vh;overflow-y:auto}@media (max-width: 768px){mat-dialog-content[_ngcontent-%COMP%]{min-width:280px}}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px}"]})};function qt(a,o){if(a&1&&(n(0,"div",18)(1,"strong"),r(2,"Kiinnostukset:"),i(),r(3),i()),a&2){let e=p();s(3),u(" ",e.data.request.interests.join(", ")," ")}}function St(a,o){if(a&1&&(n(0,"mat-option",19),r(1),i()),a&2){let e=o.$implicit;l("value",e.id),s(),u(" ",e.name," ")}}function Ot(a,o){a&1&&(n(0,"mat-error"),r(1," Valitse leikkipuisto "),i())}function kt(a,o){a&1&&(n(0,"mat-error"),r(1," Valitse p\xE4iv\xE4m\xE4\xE4r\xE4 "),i())}function Dt(a,o){if(a&1&&(n(0,"mat-option",19),r(1),i()),a&2){let e=o.$implicit;l("value",e),s(),u(" ",e," ")}}function wt(a,o){a&1&&(n(0,"mat-error"),r(1," Valitse kellonaika "),i())}function It(a,o){if(a&1&&(n(0,"mat-option",19),r(1),i()),a&2){let e=o.$implicit;l("value",e),s(),u(" ",e," h ")}}function Ft(a,o){a&1&&(n(0,"mat-error"),r(1," Valitse kesto "),i())}function Rt(a,o){a&1&&(n(0,"mat-error"),r(1," Viesti on pakollinen "),i())}function Tt(a,o){a&1&&(n(0,"mat-error"),r(1," Viesti voi olla enint\xE4\xE4n 300 merkki\xE4 "),i())}var ve=class a{constructor(o,e,t,m,d){this.fb=o;this.friendRequestService=e;this.playgroundService=t;this.dialogRef=m;this.data=d}form;isSubmitting=!1;playgrounds=[];timeSlots=[];durationOptions=[.5,1,1.5,2];minDate=new Date;ngOnInit(){this.timeSlots=Ve(),this.form=this.fb.group({playgroundId:["",v.required],date:["",v.required],time:["",v.required],duration:[1,v.required],message:["",[v.required,v.maxLength(300)]]}),this.playgroundService.getPlaygrounds().pipe(M(1)).subscribe(o=>{this.playgrounds=o})}onSubmit(){if(this.form.invalid||this.isSubmitting)return;this.isSubmitting=!0;let o=this.form.value,e=this.playgrounds.find(C=>C.id===o.playgroundId);if(!e){alert("Valitse leikkipuisto"),this.isSubmitting=!1;return}let m=new Date(o.date).toISOString().split("T")[0],d={requestId:this.data.request.id,message:o.message,playtimeDetails:{date:m,time:o.time,location:e.name,duration:o.duration,notes:""}};this.friendRequestService.proposePlaytime(d).pipe(M(1)).subscribe({next:()=>{alert("Leikkiaika-ehdotus l\xE4hetetty onnistuneesti! Ilmoituksen luoja saa sen s\xE4hk\xF6postiinsa."),this.dialogRef.close(!0)},error:C=>{console.error("Error proposing playtime:",C),alert("Ehdotuksen l\xE4hett\xE4minen ep\xE4onnistui. Yrit\xE4 uudelleen."),this.isSubmitting=!1}})}onCancel(){this.dialogRef.close()}get remainingChars(){return 300-(this.form.get("message")?.value||"").length}static \u0275fac=function(e){return new(e||a)(f(Q),f(k),f(Te),f(B),f(j))};static \u0275cmp=x({type:a,selectors:[["app-propose-playtime-dialog"]],decls:52,vars:21,consts:[["picker",""],["mat-dialog-title",""],[1,"request-info"],["class","interests",4,"ngIf"],[1,"playtime-form",3,"formGroup"],["appearance","outline",1,"full-width"],["formControlName","playgroundId","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","formControlName","date","placeholder","Valitse p\xE4iv\xE4","required","",3,"matDatepicker","min"],["matSuffix","",3,"for"],["formControlName","time","required",""],["formControlName","duration","required",""],["matInput","","formControlName","message","rows","5","placeholder","Haluaisitko tulla leikkim\xE4\xE4n huomenna? Voimme sopia tarkemman ajan!","required",""],["align","end"],[1,"info-box"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"interests"],[3,"value"]],template:function(e,t){if(e&1){let m=b();n(0,"h2",1),r(1,"Ehdota leikkiaikaa"),i(),n(2,"mat-dialog-content")(3,"div",2)(4,"h3"),r(5),i(),n(6,"p"),r(7),i(),c(8,qt,4,1,"div",3),i(),n(9,"form",4)(10,"mat-form-field",5)(11,"mat-label"),r(12,"Leikkipuisto"),i(),n(13,"mat-select",6),c(14,St,2,2,"mat-option",7),i(),c(15,Ot,2,0,"mat-error",8),i(),n(16,"mat-form-field",5)(17,"mat-label"),r(18,"P\xE4iv\xE4m\xE4\xE4r\xE4"),i(),y(19,"input",9)(20,"mat-datepicker-toggle",10)(21,"mat-datepicker",null,0),c(23,kt,2,0,"mat-error",8),i(),n(24,"mat-form-field",5)(25,"mat-label"),r(26,"Kellonaika"),i(),n(27,"mat-select",11),c(28,Dt,2,2,"mat-option",7),i(),c(29,wt,2,0,"mat-error",8),i(),n(30,"mat-form-field",5)(31,"mat-label"),r(32,"Kesto"),i(),n(33,"mat-select",12),c(34,It,2,2,"mat-option",7),i(),c(35,Ft,2,0,"mat-error",8),i(),n(36,"mat-form-field",5)(37,"mat-label"),r(38,"Viestisi"),i(),y(39,"textarea",13),n(40,"mat-hint",14),r(41),i(),c(42,Rt,2,0,"mat-error",8)(43,Tt,2,0,"mat-error",8),i(),n(44,"div",15)(45,"p"),r(46,"\u{1F4A1} Ehdotettu aika on alustava. Voitte sopia tarkan ajan yhdess\xE4 viestien kautta."),i()()()(),n(47,"mat-dialog-actions",14)(48,"button",16),g("click",function(){return _(m),h(t.onCancel())}),r(49," Peruuta "),i(),n(50,"button",17),g("click",function(){return _(m),h(t.onSubmit())}),r(51),i()()}if(e&2){let m,d,C,oe,re,Se,Oe=we(22);s(5),z("",t.data.request.childName,", ",t.data.request.childAge," v"),s(2),u("Vanhempi: ",t.data.request.parentName,""),s(),l("ngIf",t.data.request.interests&&t.data.request.interests.length>0),s(),l("formGroup",t.form),s(5),l("ngForOf",t.playgrounds),s(),l("ngIf",(m=t.form.get("playgroundId"))==null?null:m.hasError("required")),s(4),l("matDatepicker",Oe)("min",t.minDate),s(),l("for",Oe),s(3),l("ngIf",(d=t.form.get("date"))==null?null:d.hasError("required")),s(5),l("ngForOf",t.timeSlots),s(),l("ngIf",(C=t.form.get("time"))==null?null:C.hasError("required")),s(5),l("ngForOf",t.durationOptions),s(),l("ngIf",(oe=t.form.get("duration"))==null?null:oe.hasError("required")),s(6),u("",t.remainingChars," / 300 merkki\xE4 j\xE4ljell\xE4"),s(),l("ngIf",(re=t.form.get("message"))==null?null:re.hasError("required")),s(),l("ngIf",(Se=t.form.get("message"))==null?null:Se.hasError("maxlength")),s(5),l("disabled",t.isSubmitting),s(2),l("disabled",t.form.invalid||t.isSubmitting),s(),u(" ",t.isSubmitting?"L\xE4hetet\xE4\xE4n...":"L\xE4het\xE4 ehdotus"," ")}},dependencies:[P,O,E,X,U,D,w,$,J,Y,Z,W,G,K,H,S,q,R,F,I,te,ee,Le,V,T,$e,He,Ke,We,Ue,ae,ne,ie],styles:[".listing-info[_ngcontent-%COMP%]{background-color:#673ab70d;padding:16px;border-radius:4px;margin-bottom:24px}.listing-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#673ab7;font-size:18px;font-weight:600}.listing-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#0009;font-size:14px}.listing-info[_ngcontent-%COMP%]   .interests[_ngcontent-%COMP%]{font-size:14px;color:#000c;margin-top:8px}.listing-info[_ngcontent-%COMP%]   .interests[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#673ab7}.playtime-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.full-width[_ngcontent-%COMP%]{width:100%}.info-box[_ngcontent-%COMP%]{background-color:#fff3e0;border-left:4px solid #ff9800;padding:12px 16px;border-radius:4px}.info-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:1.5;color:#000c}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-height:70vh;overflow-y:auto}@media (max-width: 768px){mat-dialog-content[_ngcontent-%COMP%]{min-width:280px}}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px}"]})};function Vt(a,o){a&1&&(n(0,"div",14),y(1,"mat-spinner"),i())}function Nt(a,o){a&1&&(n(0,"p"),r(1," Kokeile muuttaa hakuehtoja. "),i())}function zt(a,o){a&1&&(n(0,"p"),r(1," Ole ensimm\xE4inen ja luo ilmoitus! "),i())}function At(a,o){if(a&1){let e=b();n(0,"div",18)(1,"mat-icon"),r(2,"inbox"),i(),n(3,"h3"),r(4,"Ei ilmoituksia"),i(),c(5,Nt,2,0,"p",19)(6,zt,2,0,"p",19),n(7,"button",20),g("click",function(){_(e);let m=p(2);return h(m.onCreateRequest())}),n(8,"mat-icon"),r(9,"add"),i(),r(10," Luo ilmoitus "),i()()}if(a&2){let e=p(2);s(5),l("ngIf",e.searchText||e.selectedAge!==null),s(),l("ngIf",!e.searchText&&e.selectedAge===null)}}function Lt(a,o){if(a&1){let e=b();n(0,"app-friend-request-card",24),g("sendMessage",function(m){_(e);let d=p(3);return h(d.onSendMessage(m))})("proposePlaytime",function(m){_(e);let d=p(3);return h(d.onProposePlaytime(m))})("edit",function(m){_(e);let d=p(3);return h(d.onEditRequest(m))})("delete",function(m){_(e);let d=p(3);return h(d.onDeleteRequest(m))})("close",function(m){_(e);let d=p(3);return h(d.onCloseRequest(m))}),i()}if(a&2){let e=o.$implicit,t=p(3);l("request",e)("isOwner",t.isOwner(e))}}function Bt(a,o){if(a&1){let e=b();n(0,"div",21),c(1,Lt,1,2,"app-friend-request-card",22),n(2,"div",23),g("click",function(){_(e);let m=p(2);return h(m.onCreateRequest())}),n(3,"mat-icon"),r(4,"add"),i(),n(5,"span"),r(6,"Uusi kaverihaku"),i()()()}if(a&2){let e=p(2);s(),l("ngForOf",e.filteredRequests)}}function jt(a,o){if(a&1&&(n(0,"div",15),c(1,At,11,2,"div",16)(2,Bt,7,1,"div",17),i()),a&2){let e=p();s(),l("ngIf",e.filteredRequests.length===0),s(),l("ngIf",e.filteredRequests.length>0)}}function Gt(a,o){if(a&1&&(n(0,"mat-option",12),r(1),i()),a&2){let e=o.$implicit;l("value",e),s(),u(" ",e," vuotta ")}}var rt=class a{constructor(o,e,t,m){this.friendRequestService=o;this.supabaseService=e;this.dialog=t;this.router=m}requests=[];filteredRequests=[];isLoading=!0;currentUserId=null;searchText="";selectedStatus="active";selectedAge=null;requestsSubscription;ageOptions=[0,1,2,3,4,5,6,7];ngOnInit(){let o=this.supabaseService.getSession();this.currentUserId=o?.user?.id||null,this.requestsSubscription=this.friendRequestService.getAllRequests().subscribe(e=>{this.requests=e,this.applyFilters(),this.isLoading=!1})}ngOnDestroy(){this.requestsSubscription?.unsubscribe()}applyFilters(){let o=[...this.requests];if(this.selectedStatus!=="all"&&(o=o.filter(e=>e.status===this.selectedStatus)),this.selectedAge!==null&&(o=o.filter(e=>e.childAge===this.selectedAge)),this.searchText.trim()){let e=this.searchText.toLowerCase();o=o.filter(t=>t.childName.toLowerCase().includes(e)||t.parentName.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.city.toLowerCase().includes(e)||t.interests.some(m=>m.toLowerCase().includes(e)))}this.filteredRequests=o}onSearchChange(){this.applyFilters()}onStatusChange(){this.applyFilters()}onAgeChange(){this.applyFilters()}onCreateRequest(){this.dialog.open(_e,{width:"600px",maxWidth:"95vw",data:{latitude:60.9823,longitude:25.6551,city:"Lahti"}}).afterClosed().subscribe(e=>{})}onSendMessage(o){this.dialog.open(he,{width:"500px",maxWidth:"95vw",data:{request:o}})}onProposePlaytime(o){this.dialog.open(ve,{width:"600px",maxWidth:"95vw",data:{request:o}})}onEditRequest(o){alert("Muokkaus-toiminto tulossa pian!")}onDeleteRequest(o){this.friendRequestService.deleteFriendRequest(o.id).pipe(M(1)).subscribe({next:()=>{},error:e=>{console.error("Error deleting request:",e),alert("Ilmoituksen poisto ep\xE4onnistui. Yrit\xE4 uudelleen.")}})}onCloseRequest(o){this.friendRequestService.closeFriendRequest(o.id).pipe(M(1)).subscribe({next:()=>{},error:e=>{console.error("Error closing request:",e),alert("Ilmoituksen sulkeminen ep\xE4onnistui. Yrit\xE4 uudelleen.")}})}isOwner(o){return this.currentUserId!==null&&o.user_id===this.currentUserId}goBack(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||a)(f(k),f(Je),f(Re),f(Ie))};static \u0275cmp=x({type:a,selectors:[["app-friend-request-table-page"]],decls:27,vars:7,consts:[[1,"table-page-container"],["class","loading-container",4,"ngIf"],["class","requests-container",4,"ngIf"],[1,"filters-section"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Etsi nimell\xE4, kiinnostuksilla, kaupungilla...",3,"ngModelChange","ngModel"],["matPrefix",""],["appearance","outline",1,"filter-field"],[3,"ngModelChange","ngModel"],["value","all"],["value","active"],["value","closed"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"loading-container"],[1,"requests-container"],["class","empty-state",4,"ngIf"],["class","requests-grid",4,"ngIf"],[1,"empty-state"],[4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"requests-grid"],[3,"request","isOwner","sendMessage","proposePlaytime","edit","delete","close",4,"ngFor","ngForOf"],[1,"create-card",3,"click"],[3,"sendMessage","proposePlaytime","edit","delete","close","request","isOwner"]],template:function(e,t){e&1&&(n(0,"div",0),c(1,Vt,2,0,"div",1)(2,jt,3,2,"div",2),n(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),r(6,"Hae"),i(),n(7,"input",5),de("ngModelChange",function(d){return me(t.searchText,d)||(t.searchText=d),d}),g("ngModelChange",function(){return t.onSearchChange()}),i(),n(8,"mat-icon",6),r(9,"search"),i()(),n(10,"mat-form-field",7)(11,"mat-label"),r(12,"Tila"),i(),n(13,"mat-select",8),de("ngModelChange",function(d){return me(t.selectedStatus,d)||(t.selectedStatus=d),d}),g("ngModelChange",function(){return t.onStatusChange()}),n(14,"mat-option",9),r(15,"Kaikki"),i(),n(16,"mat-option",10),r(17,"Aktiiviset"),i(),n(18,"mat-option",11),r(19,"Ratkaistut"),i()()(),n(20,"mat-form-field",7)(21,"mat-label"),r(22,"Ik\xE4"),i(),n(23,"mat-select",8),de("ngModelChange",function(d){return me(t.selectedAge,d)||(t.selectedAge=d),d}),g("ngModelChange",function(){return t.onAgeChange()}),n(24,"mat-option",12),r(25,"Kaikki i\xE4t"),i(),c(26,Gt,2,2,"mat-option",13),i()()()()),e&2&&(s(),l("ngIf",t.isLoading),s(),l("ngIf",!t.isLoading),s(5),le("ngModel",t.searchText),s(6),le("ngModel",t.selectedStatus),s(10),le("ngModel",t.selectedAge),s(),l("value",null),s(2),l("ngForOf",t.ageOptions))},dependencies:[P,O,E,ze,D,w,Ne,S,q,L,A,R,F,I,Ae,V,T,ae,ne,ie,Ze,Ye,pe],styles:[".table-page-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f5f5f5;padding-bottom:100px;position:relative}.filters-section[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background-color:#fff;padding:16px;box-shadow:0 -2px 8px #0000001a;z-index:100;max-width:1200px;margin:0 auto;display:flex;gap:16px;flex-wrap:wrap}.filters-section[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{flex:1;min-width:250px}.filters-section[_ngcontent-%COMP%]   .filter-field[_ngcontent-%COMP%]{min-width:150px}@media (max-width: 768px){.filters-section[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%], .filters-section[_ngcontent-%COMP%]   .filter-field[_ngcontent-%COMP%]{width:100%;min-width:100%}}.fab-button[_ngcontent-%COMP%]{position:fixed;bottom:120px;right:24px;z-index:101}.fab-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}@media (max-width: 768px){.fab-button[_ngcontent-%COMP%]{bottom:140px;right:16px}}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:400px}.listings-container[_ngcontent-%COMP%]{padding:24px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:64px 24px;text-align:center;color:#0009}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#0000004d;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:20px;color:#000000de}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 24px;font-size:14px}.empty-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;margin-right:8px;color:#fff}.requests-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px}.requests-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:24px;max-width:1200px}@media (min-width: 769px){.requests-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(max(250px,(100% - 72px) / 4),1fr))}}@media (max-width: 768px){.requests-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}}.create-card[_ngcontent-%COMP%]{background-color:#fff;border:2px dashed #4CAF50;border-radius:8px;padding:48px 24px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;cursor:pointer;transition:all .3s ease;min-height:200px}.create-card[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#4caf50}.create-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#4caf50}.create-card[_ngcontent-%COMP%]:hover{background-color:#f1f8e9;border-color:#388e3c;transform:translateY(-2px);box-shadow:0 4px 12px #4caf5033}.create-card[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%], .create-card[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:#388e3c}.create-card[_ngcontent-%COMP%]:active{transform:translateY(0)}"]})};export{rt as FriendRequestTablePageComponent};
