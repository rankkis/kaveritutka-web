import{a as x,b as M}from"./chunk-IKLCL2V4.js";import{a as S}from"./chunk-YIVOTSJ4.js";import"./chunk-X5YLR3NI.js";import{h,p as v,r as C}from"./chunk-642DS5T4.js";import{$a as c,Cb as g,Fb as r,Gb as a,Hb as d,Mb as f,Wb as s,Xb as b,eb as o,lb as m,qb as p}from"./chunk-3324XCKI.js";import"./chunk-ODN5LVDJ.js";function k(n,t){if(n&1&&(r(0,"p",2),s(1),a()),n&2){let e=f();c(),b(e.errorMessage)}}function O(n,t){n&1&&(r(0,"p",3),s(1,"Kirjaudutaan sis\xE4\xE4n..."),a())}var _=class n{constructor(t,e,i){this.route=t;this.router=e;this.supabaseService=i}errorMessage="";ngOnInit(){this.route.queryParams.subscribe(t=>{let e=t.error,i=t.error_description;if(e){this.errorMessage=i||"Kirjautuminen ep\xE4onnistui. Yrit\xE4 uudelleen.",console.error("OAuth error:",e,i),setTimeout(()=>this.router.navigate(["/"]),3e3);return}let l=this.supabaseService.session$.subscribe(u=>{u&&(console.log("Authentication successful:",u.user.email),l.unsubscribe(),this.checkIfNewUser()?this.router.navigate(["/welcome"]):this.router.navigate(["/"]))});setTimeout(()=>{this.supabaseService.getSession()||(l.unsubscribe(),this.errorMessage="Kirjautuminen ep\xE4onnistui. Yrit\xE4 uudelleen.",setTimeout(()=>this.router.navigate(["/"]),2e3))},5e3)})}checkIfNewUser(){return localStorage.getItem("hasSeenWelcome")?!1:(localStorage.setItem("hasSeenWelcome","true"),!0)}static \u0275fac=function(e){return new(e||n)(o(v),o(C),o(S))};static \u0275cmp=m({type:n,selectors:[["app-auth-callback"]],decls:4,vars:1,consts:[[1,"callback-container"],["diameter","60"],[1,"error-message"],[1,"loading-message"]],template:function(e,i){e&1&&(r(0,"div",0),d(1,"mat-spinner",1),p(2,k,2,1,"p",2)(3,O,2,0,"p",3),a()),e&2&&(c(2),g(i.errorMessage?2:3))},dependencies:[h,M,x],styles:[".callback-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 64px);padding:40px 20px;background-color:#f5f5f5;text-align:center}.callback-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:24px}.callback-container[_ngcontent-%COMP%]   .loading-message[_ngcontent-%COMP%]{font-size:18px;color:#000000b3;margin:0}.callback-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{font-size:16px;color:#f44336;margin:0}@media (max-width: 768px){.callback-container[_ngcontent-%COMP%]{min-height:calc(100vh - 56px);padding:32px 16px}.callback-container[_ngcontent-%COMP%]   .loading-message[_ngcontent-%COMP%], .callback-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{font-size:16px}}"]})};export{_ as AuthCallbackComponent};
