import{e as C,h as Y,i as B,j as J,m as q,q as Q,r as W}from"./chunk-VJJCL42P.js";import{C as R,D as K,b as I,d as D,f as V,g as N,j as A,k as G,l as $,n as z,p as L,q as j,x as H,y as U}from"./chunk-JZXY3VKR.js";import{a as E}from"./chunk-765JHOPI.js";import{p as T}from"./chunk-R7O3L3SZ.js";import{e as w,f as F,i as S}from"./chunk-HGBHGORQ.js";import{$a as c,$b as l,Ab as d,Cb as x,Ib as a,Jb as o,Kb as M,Ob as b,Qb as u,Rb as s,ac as v,bc as h,eb as O,la as g,lb as k,ma as _,rb as p,wa as P}from"./chunk-LH7KODYS.js";function te(r,t){if(r&1){let e=b();a(0,"button",18),u("click",function(){let i=g(e).$implicit,m=s();return _(m.selectDate(i.value))}),l(1),o()}if(r&2){let e=t.$implicit,n=s();x("selected",n.selectedDate===e.value),c(),h(" ",e.label," ")}}function ne(r,t){if(r&1&&(a(0,"mat-option",19),l(1),o()),r&2){let e=t.$implicit,n=s();d("value",e),c(),h(" ",n.getTimeLabel(e)," ")}}function ie(r,t){if(r&1){let e=b();a(0,"button",20),u("click",function(){let i=g(e).$implicit,m=s();return _(m.selectDuration(i.value))}),l(1),o()}if(r&2){let e=t.$implicit,n=s();x("selected",n.selectedDuration===e.value),c(),h(" ",e.label," ")}}function oe(r,t){if(r&1){let e=b();a(0,"button",29),u("click",function(){g(e);let i=s().index,m=s();return _(m.removeParticipant(i))}),l(1," \u2715 "),o()}}function re(r,t){if(r&1){let e=b();a(0,"button",30),u("click",function(){let i=g(e).$implicit,m=s().index,f=s();return _(f.selectAge(m,i))}),l(1),o()}if(r&2){let e=t.$implicit,n=s().$implicit;x("selected",n.childAge===e),c(),h(" ",e,"v ")}}function ae(r,t){if(r&1){let e=b();a(0,"button",31),u("click",function(){let i=g(e).$implicit,m=s().index,f=s();return _(f.selectGender(m,i.value))}),a(1,"span",32),l(2),o(),a(3,"span",33),l(4),o()()}if(r&2){let e=t.$implicit,n=s().$implicit;x("selected",n.childGender===e.value),c(2),v(e.icon),c(2),v(e.label)}}function le(r,t){if(r&1){let e=b();a(0,"button",34),u("click",function(){g(e);let i=s().index,m=s();return _(m.removeGenderSelection(i))}),l(1," Poista valinta "),o()}}function ce(r,t){if(r&1){let e=b();a(0,"button",35),u("click",function(){let i=g(e).$implicit,m=s().index,f=s();return _(f.toggleInterest(m,i.value))}),l(1),o()}if(r&2){let e=t.$implicit,n=s().index,i=s();x("selected",i.isInterestSelected(n,e.value)),c(),h(" ",e.label," ")}}function se(r,t){r&1&&(a(0,"div",36),l(1," Valitse v\xE4hint\xE4\xE4n yksi kiinnostuksen kohde "),o())}function me(r,t){if(r&1){let e=b();a(0,"button",37),u("click",function(){g(e);let i=s(2);return _(i.addParticipant())}),l(1," + Lis\xE4\xE4 osallistuja "),o()}}function de(r,t){if(r&1&&(a(0,"fieldset",1)(1,"legend",2),l(2),p(3,oe,2,0,"button",21),o(),a(4,"div",5)(5,"label",6),l(6,"Lapsen ik\xE4"),o(),a(7,"div",7),p(8,re,2,3,"button",22),o()(),a(9,"div",5)(10,"label",6),l(11,"Sukupuoli (valinnainen)"),o(),a(12,"div",7),p(13,ae,5,4,"button",23)(14,le,2,0,"button",24),o()(),a(15,"div",5)(16,"label",6),l(17,"Kiinnostuksen kohteet (valitse v\xE4hint\xE4\xE4n yksi)"),o(),a(18,"div",25),p(19,ce,2,3,"button",26),o(),p(20,se,2,0,"div",27),o(),p(21,me,2,0,"button",28),o()),r&2){let e=t.$implicit,n=t.index,i=s();c(2),h(" ",i.getParticipantTitle(n)," "),c(),d("ngIf",i.participants.length>1),c(5),d("ngForOf",i.ageOptions),c(5),d("ngForOf",i.genderOptions),c(),d("ngIf",e.childGender!==null),c(5),d("ngForOf",i.availableInterests),c(),d("ngIf",i.submitted&&e.interests.length===0),c(),d("ngIf",n===i.participants.length-1&&i.isParticipantValid(n))}}var X=class r{constructor(t,e){this.fb=t;this.userService=e;this.playtimeForm=this.fb.group({parentName:[""],scheduledTime:["now",D.required],additionalInfo:[""]})}playground;formSubmit=new P;formCancel=new P;playtimeForm;userSubscription;dateOptions=[];selectedDate="today";timeOptions=[];durationOptions=[{value:.5,label:"0,5h"},{value:1,label:"1h"},{value:1.5,label:"1,5h"},{value:2,label:"2h"}];selectedDuration=1;ageOptions=[0,1,2,3,4,5,6];genderOptions=[{value:"boy",icon:"\u{1F466}",label:"Poika"},{value:"girl",icon:"\u{1F467}",label:"Tytt\xF6"}];availableInterests=[{value:"jalkapallo",label:"Jalkapallo"},{value:"keinut",label:"Keinut"},{value:"liukum\xE4et",label:"Liukum\xE4et"},{value:"hiekkalaatikko",label:"Hiekkalaatikko"},{value:"kiipeily",label:"Kiipeily"},{value:"juokseminen",label:"Juokseminen"},{value:"py\xF6r\xE4ily",label:"Py\xF6r\xE4ily"},{value:"pallopelit",label:"Pallopelit"}];participants=[{childAge:3,childGender:null,interests:[]}];submitted=!1;ngOnInit(){this.updateDateOptions(),this.updateTimeOptions(),this.userSubscription=this.userService.getCurrentUser().subscribe(t=>{if(t&&t.displayName){let e=this.playtimeForm.get("parentName")?.value;(!e||e==="")&&this.playtimeForm.patchValue({parentName:t.displayName})}})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}roundToNearest15Minutes(t){let e=new Date(t),n=e.getMinutes(),i=Math.ceil(n/15)*15;return e.setMinutes(i),e.setSeconds(0),e.setMilliseconds(0),e}updateDateOptions(){this.dateOptions=[];let t=new Date;this.roundToNearest15Minutes(t).getHours()<=C.END_HOUR?this.dateOptions.push({value:"today",label:"T\xE4n\xE4\xE4n"}):this.selectedDate="tomorrow",this.dateOptions.push({value:"tomorrow",label:"Huomenna"})}updateTimeOptions(){this.timeOptions=[];let t=new Date,e=this.roundToNearest15Minutes(t),n=this.selectedDate==="today",i=n?e.getHours():C.START_HOUR,m=n?e.getMinutes():0;this.timeOptions.push("now");for(let f=i;f<=C.END_HOUR;f++){let Z=f===i?m:0;for(let y=Z;y<60;y+=C.INTERVAL_MINUTES){let ee=`${f.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`;this.timeOptions.push(ee)}}}selectDate(t){this.selectedDate=t,this.updateTimeOptions(),this.playtimeForm.patchValue({scheduledTime:"now"})}selectDuration(t){this.selectedDuration=t}selectAge(t,e){this.participants[t].childAge=e}selectGender(t,e){this.participants[t].childGender=e}removeGenderSelection(t){this.participants[t].childGender=null}toggleInterest(t,e){let n=this.participants[t].interests,i=n.indexOf(e);i>-1?n.splice(i,1):n.push(e)}isInterestSelected(t,e){return this.participants[t].interests.includes(e)}getTimeLabel(t){return t==="now"?"Nyt":t}getParticipantTitle(t){let e=this.participants[t],n=`${e.childAge}v`,i="lapsi";return e.childGender==="boy"?i="poika":e.childGender==="girl"&&(i="tytt\xF6"),`${n}-${i}`}isParticipantValid(t){return this.participants[t].interests.length>0}addParticipant(){this.participants.push({childAge:3,childGender:null,interests:[]})}removeParticipant(t){this.participants.length>1&&this.participants.splice(t,1)}areAllParticipantsValid(){return this.participants.every(t=>t.interests.length>0)}onSubmit(){this.submitted=!0;let t=this.participants.every(e=>e.interests.length>0);if(this.playtimeForm.valid&&t){let e=this.playtimeForm.value,n=this.calculateScheduledTime(),i={playgroundId:this.playground.id,parentName:e.parentName?.trim()||"Anonyymi",scheduledTime:n,duration:this.selectedDuration,participants:this.participants.map(m=>({childAge:m.childAge,childGender:m.childGender,interests:m.interests})),additionalInfo:e.additionalInfo||void 0};this.formSubmit.emit(i)}}calculateScheduledTime(){let t=this.playtimeForm.value.scheduledTime;if(t==="now")return new Date;let e=new Date;this.selectedDate==="tomorrow"&&e.setDate(e.getDate()+1);let[n,i]=t.split(":").map(m=>parseInt(m,10));return e.setHours(n,i,0,0),e}onCancel(){this.formCancel.emit()}static \u0275fac=function(e){return new(e||r)(O(z),O(E))};static \u0275cmp=k({type:r,selectors:[["app-playtime-form"]],inputs:{playground:"playground"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},decls:34,vars:7,consts:[[1,"playtime-form",3,"formGroup"],[1,"form-fieldset"],[1,"fieldset-legend"],["appearance","outline","floatLabel","always",1,"full-width"],["matInput","","formControlName","parentName","placeholder","Voit j\xE4tt\xE4\xE4 tyhj\xE4ksi"],[1,"form-section"],[1,"section-label"],[1,"chip-row"],["type","button","class","selection-chip",3,"selected","click",4,"ngFor","ngForOf"],["appearance","outline",1,"full-width"],["formControlName","scheduledTime"],[3,"value",4,"ngFor","ngForOf"],["type","button","class","selection-chip duration-chip",3,"selected","click",4,"ngFor","ngForOf"],["matInput","","formControlName","additionalInfo","rows","3","placeholder","Esim. kuinka kauan oleskelette, mit\xE4 v\xE4lineit\xE4 otatte mukaan, jne."],["class","form-fieldset",4,"ngFor","ngForOf"],[1,"form-actions"],["type","button",1,"cancel-btn",3,"click"],["type","button",1,"submit-btn",3,"click","disabled"],["type","button",1,"selection-chip",3,"click"],[3,"value"],["type","button",1,"selection-chip","duration-chip",3,"click"],["type","button","class","remove-participant-btn",3,"click",4,"ngIf"],["type","button","class","selection-chip age-chip",3,"selected","click",4,"ngFor","ngForOf"],["type","button","class","selection-chip gender-chip",3,"selected","click",4,"ngFor","ngForOf"],["type","button","class","remove-selection-btn",3,"click",4,"ngIf"],[1,"interests-grid"],["type","button","class","interest-chip",3,"selected","click",4,"ngFor","ngForOf"],["class","error-message",4,"ngIf"],["type","button","class","add-participant-btn",3,"click",4,"ngIf"],["type","button",1,"remove-participant-btn",3,"click"],["type","button",1,"selection-chip","age-chip",3,"click"],["type","button",1,"selection-chip","gender-chip",3,"click"],[1,"icon"],[1,"label"],["type","button",1,"remove-selection-btn",3,"click"],["type","button",1,"interest-chip",3,"click"],[1,"error-message"],["type","button",1,"add-participant-btn",3,"click"]],template:function(e,n){e&1&&(a(0,"form",0)(1,"fieldset",1)(2,"legend",2),l(3),o(),a(4,"mat-form-field",3)(5,"mat-label"),l(6,"Nimi (valinnainen)"),o(),M(7,"input",4),o(),a(8,"div",5)(9,"label",6),l(10,"P\xE4iv\xE4m\xE4\xE4r\xE4"),o(),a(11,"div",7),p(12,te,2,3,"button",8),o()(),a(13,"div",5)(14,"label",6),l(15,"Kellonaika"),o(),a(16,"mat-form-field",9)(17,"mat-select",10),p(18,ne,2,2,"mat-option",11),o()()(),a(19,"div",5)(20,"label",6),l(21,"Kesto"),o(),a(22,"div",7),p(23,ie,2,3,"button",12),o()(),a(24,"mat-form-field",9)(25,"mat-label"),l(26,"Lis\xE4tiedot (valinnainen)"),o(),M(27,"textarea",13),o()(),p(28,de,22,8,"fieldset",14),a(29,"div",15)(30,"button",16),u("click",function(){return n.onCancel()}),l(31,"Peruuta"),o(),a(32,"button",17),u("click",function(){return n.onSubmit()}),l(33," Leikkim\xE4\xE4n! "),o()()()),e&2&&(d("formGroup",n.playtimeForm),c(3),v(n.playground.name),c(9),d("ngForOf",n.dateOptions),c(6),d("ngForOf",n.timeOptions),c(5),d("ngForOf",n.durationOptions),c(5),d("ngForOf",n.participants),c(4),d("disabled",!n.playtimeForm.valid||!n.areAllParticipantsValid()))},dependencies:[S,w,F,L,A,I,V,N,G,$,U,H,j,K,R,J,B,Y,T,q,Q,W],styles:[".playtime-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;padding:1rem 0;width:100%;box-sizing:border-box}@media (max-width: 768px){.playtime-form[_ngcontent-%COMP%]{gap:1rem;padding:.5rem 0}}.form-fieldset[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;padding:1.5rem;margin:0;display:flex;flex-direction:column;gap:1.25rem;position:relative}.form-fieldset[_ngcontent-%COMP%]   .fieldset-legend[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#4caf50;padding:0 .5rem;margin-bottom:0;display:flex;align-items:center;gap:.75rem}.form-fieldset[_ngcontent-%COMP%]   .remove-participant-btn[_ngcontent-%COMP%]{background:#f44336;color:#fff;border:none;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:.9rem;transition:all .2s ease;padding:0;line-height:1}.form-fieldset[_ngcontent-%COMP%]   .remove-participant-btn[_ngcontent-%COMP%]:hover{background:#d32f2f;transform:scale(1.1)}.form-fieldset[_ngcontent-%COMP%]   .add-participant-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:2px dashed #4CAF50;background:#fff;border-radius:8px;cursor:pointer;font-size:.95rem;font-weight:500;color:#4caf50;transition:all .2s ease;width:100%}.form-fieldset[_ngcontent-%COMP%]   .add-participant-btn[_ngcontent-%COMP%]:hover{background:#f1f8f4;border-style:solid;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{display:block;font-size:.9rem;font-weight:500;color:#666;margin-bottom:.75rem}.form-section[_ngcontent-%COMP%]   .chip-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.form-section[_ngcontent-%COMP%]   .selection-chip[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border:2px solid #e0e0e0;background:#fff;border-radius:24px;cursor:pointer;font-size:.95rem;font-weight:500;transition:all .2s ease;color:#333}.form-section[_ngcontent-%COMP%]   .selection-chip[_ngcontent-%COMP%]:hover{border-color:#4caf50;background:#f1f8f4;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .selection-chip.selected[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border-color:#4caf50;box-shadow:0 2px 4px #4caf504d}.form-section[_ngcontent-%COMP%]   .selection-chip.age-chip[_ngcontent-%COMP%]{min-width:50px;padding:.6rem .8rem}.form-section[_ngcontent-%COMP%]   .selection-chip.gender-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.form-section[_ngcontent-%COMP%]   .selection-chip.gender-chip[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.3rem}.form-section[_ngcontent-%COMP%]   .selection-chip.gender-chip[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.9rem}.form-section[_ngcontent-%COMP%]   .remove-selection-btn[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border:2px solid #f44336;background:#fff;border-radius:24px;cursor:pointer;font-size:.9rem;color:#f44336;transition:all .2s ease}.form-section[_ngcontent-%COMP%]   .remove-selection-btn[_ngcontent-%COMP%]:hover{background:#ffebee;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .interests-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:.5rem}.form-section[_ngcontent-%COMP%]   .interest-chip[_ngcontent-%COMP%]{padding:.6rem 1rem;border:2px solid #e0e0e0;background:#fff;border-radius:20px;cursor:pointer;font-size:.9rem;transition:all .2s ease;text-align:center}.form-section[_ngcontent-%COMP%]   .interest-chip[_ngcontent-%COMP%]:hover{border-color:#4caf50;background:#f1f8f4;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .interest-chip.selected[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border-color:#4caf50}.form-section[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#f44336;font-size:.75rem;margin-top:.5rem}mat-form-field[_ngcontent-%COMP%]{width:100%;margin:0}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{background-color:#fff}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-select-value{color:#333;z-index:1;position:relative}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-select-trigger{background-color:#fff}mat-form-field[_ngcontent-%COMP%]     textarea.mat-mdc-input-element{resize:none;z-index:1;position:relative;background-color:#fff}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-input-element{background-color:#fff;color:#333;z-index:2;position:relative}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-input-element::placeholder{opacity:1;color:#0009}mat-form-field[_ngcontent-%COMP%]     input.mat-mdc-input-element{pointer-events:auto;cursor:text}mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline{background-color:#fff}mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__leading, mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__notch, mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__trailing{background-color:#fff}.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;padding:1.5rem 0 0;border-top:1px solid #e0e0e0;margin-top:.5rem}@media (max-width: 768px){.form-actions[_ngcontent-%COMP%]{padding:1rem 0 0}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}}.form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:1px solid #999;background:#fff;border-radius:4px;cursor:pointer;font-size:.95rem;font-weight:500;color:#666;transition:all .2s ease}.form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;background:#4caf50;border-radius:4px;cursor:pointer;font-size:.95rem;font-weight:500;color:#fff;transition:all .2s ease;box-shadow:0 2px 4px #0000001a}.form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#45a049;box-shadow:0 3px 6px #00000026}.form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed;box-shadow:none}"]})};export{X as a};
