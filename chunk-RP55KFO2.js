import{a as $,b as z,d as L,e as R,f as j,g as H}from"./chunk-35YCIJCZ.js";import{a as w,b as E,c as S,d as T,e as F,f as V,g as N,h as A,i as G,j as B,k as K,l as Y,m as U,n as J,o as q,p as Q,q as W,r as X,s as Z,t as ee,u as te,v as ne,w as v,x as ie}from"./chunk-TSLVDBLJ.js";import{d as I,e as y,g as D}from"./chunk-4MKTNDPE.js";import{Gb as l,Hb as k,Ib as b,Na as s,Sa as x,Za as P,cb as p,ib as m,ja as f,ka as _,kb as C,qb as r,rb as o,sb as O,tb as h,vb as u,wb as d}from"./chunk-WLRQ2KVN.js";function le(a,t){if(a&1){let e=h();r(0,"button",19),u("click",function(){let i=f(e).$implicit,c=d();return _(c.selectDate(i.value))}),l(1),o()}if(a&2){let e=t.$implicit,n=d();C("selected",n.selectedDate===e.value),s(),b(" ",e.label," ")}}function ce(a,t){if(a&1&&(r(0,"mat-option",20),l(1),o()),a&2){let e=t.$implicit,n=d();m("value",e),s(),b(" ",n.getTimeLabel(e)," ")}}function se(a,t){if(a&1){let e=h();r(0,"button",21),u("click",function(){let i=f(e).$implicit,c=d();return _(c.selectDuration(i.value))}),l(1),o()}if(a&2){let e=t.$implicit,n=d();C("selected",n.selectedDuration===e.value),s(),b(" ",e.label," ")}}function de(a,t){if(a&1){let e=h();r(0,"button",30),u("click",function(){f(e);let i=d().index,c=d();return _(c.removeParticipant(i))}),l(1," \u2715 "),o()}}function me(a,t){if(a&1){let e=h();r(0,"button",31),u("click",function(){let i=f(e).$implicit,c=d().index,g=d();return _(g.selectAge(c,i))}),l(1),o()}if(a&2){let e=t.$implicit,n=d().$implicit;C("selected",n.childAge===e),s(),b(" ",e,"v ")}}function pe(a,t){if(a&1){let e=h();r(0,"button",32),u("click",function(){let i=f(e).$implicit,c=d().index,g=d();return _(g.selectGender(c,i.value))}),r(1,"span",33),l(2),o(),r(3,"span",34),l(4),o()()}if(a&2){let e=t.$implicit,n=d().$implicit;C("selected",n.childGender===e.value),s(2),k(e.icon),s(2),k(e.label)}}function ue(a,t){if(a&1){let e=h();r(0,"button",35),u("click",function(){f(e);let i=d().index,c=d();return _(c.removeGenderSelection(i))}),l(1," Poista valinta "),o()}}function ge(a,t){if(a&1){let e=h();r(0,"button",36),u("click",function(){let i=f(e).$implicit,c=d().index,g=d();return _(g.toggleInterest(c,i.value))}),l(1),o()}if(a&2){let e=t.$implicit,n=d().index,i=d();C("selected",i.isInterestSelected(n,e.value)),s(),b(" ",e.label," ")}}function fe(a,t){a&1&&(r(0,"div",37),l(1," Valitse v\xE4hint\xE4\xE4n yksi kiinnostuksen kohde "),o())}function _e(a,t){if(a&1){let e=h();r(0,"button",38),u("click",function(){f(e);let i=d(2);return _(i.addParticipant())}),l(1," + Lis\xE4\xE4 osallistuja "),o()}}function he(a,t){if(a&1&&(r(0,"fieldset",2)(1,"legend",3),l(2),p(3,de,2,0,"button",22),o(),r(4,"div",6)(5,"label",7),l(6,"Lapsen ik\xE4"),o(),r(7,"div",8),p(8,me,2,3,"button",23),o()(),r(9,"div",6)(10,"label",7),l(11,"Sukupuoli (valinnainen)"),o(),r(12,"div",8),p(13,pe,5,4,"button",24)(14,ue,2,0,"button",25),o()(),r(15,"div",6)(16,"label",7),l(17,"Kiinnostuksen kohteet (valitse v\xE4hint\xE4\xE4n yksi)"),o(),r(18,"div",26),p(19,ge,2,3,"button",27),o(),p(20,fe,2,0,"div",28),o(),p(21,_e,2,0,"button",29),o()),a&2){let e=t.$implicit,n=t.index,i=d();s(2),b(" ",i.getParticipantTitle(n)," "),s(),m("ngIf",i.participants.length>1),s(5),m("ngForOf",i.ageOptions),s(5),m("ngForOf",i.genderOptions),s(),m("ngIf",e.childGender!==null),s(5),m("ngForOf",i.availableInterests),s(),m("ngIf",i.submitted&&e.interests.length===0),s(),m("ngIf",n===i.participants.length-1&&i.isParticipantValid(n))}}var oe=class a{constructor(t,e,n,i){this.fb=t;this.dialogRef=e;this.checkInService=n;this.data=i;this.updateDateOptions(),this.updateTimeOptions(),this.checkInForm=this.fb.group({parentName:[""],scheduledTime:["now",E.required],additionalInfo:[""]})}checkInForm;dateOptions=[];selectedDate="today";timeOptions=[];durationOptions=[{value:.5,label:"0,5h"},{value:1,label:"1h"},{value:1.5,label:"1,5h"},{value:2,label:"2h"}];selectedDuration=1;ageOptions=[0,1,2,3,4,5,6];genderOptions=[{value:"boy",icon:"\u{1F466}",label:"Poika"},{value:"girl",icon:"\u{1F467}",label:"Tytt\xF6"}];availableInterests=[{value:"jalkapallo",label:"Jalkapallo"},{value:"keinut",label:"Keinut"},{value:"liukum\xE4et",label:"Liukum\xE4et"},{value:"hiekkalaatikko",label:"Hiekkalaatikko"},{value:"kiipeily",label:"Kiipeily"},{value:"juokseminen",label:"Juokseminen"},{value:"py\xF6r\xE4ily",label:"Py\xF6r\xE4ily"},{value:"pallopelit",label:"Pallopelit"}];participants=[{childAge:3,childGender:null,interests:[]}];submitted=!1;roundToNearest15Minutes(t){let e=new Date(t),n=e.getMinutes(),i=Math.ceil(n/15)*15;return e.setMinutes(i),e.setSeconds(0),e.setMilliseconds(0),e}updateDateOptions(){this.dateOptions=[];let t=new Date;this.roundToNearest15Minutes(t).getHours()<=v.END_HOUR?this.dateOptions.push({value:"today",label:"T\xE4n\xE4\xE4n"}):this.selectedDate="tomorrow",this.dateOptions.push({value:"tomorrow",label:"Huomenna"})}updateTimeOptions(){this.timeOptions=[];let t=new Date,e=this.roundToNearest15Minutes(t),n=this.selectedDate==="today",i=n?e.getHours():v.START_HOUR,c=n?e.getMinutes():0;this.timeOptions.push("now");for(let g=i;g<=v.END_HOUR;g++){let re=g===i?c:0;for(let M=re;M<60;M+=v.INTERVAL_MINUTES){let ae=`${g.toString().padStart(2,"0")}:${M.toString().padStart(2,"0")}`;this.timeOptions.push(ae)}}}selectDate(t){this.selectedDate=t,this.updateTimeOptions(),this.checkInForm.patchValue({scheduledTime:"now"})}selectDuration(t){this.selectedDuration=t}selectAge(t,e){this.participants[t].childAge=e}selectGender(t,e){this.participants[t].childGender=e}removeGenderSelection(t){this.participants[t].childGender=null}toggleInterest(t,e){let n=this.participants[t].interests,i=n.indexOf(e);i>-1?n.splice(i,1):n.push(e)}isInterestSelected(t,e){return this.participants[t].interests.includes(e)}getTimeLabel(t){return t==="now"?"Nyt":t}getParticipantTitle(t){let e=this.participants[t],n=`${e.childAge}v`,i="lapsi";return e.childGender==="boy"?i="poika":e.childGender==="girl"&&(i="tytt\xF6"),`${n}-${i}`}isParticipantValid(t){return this.participants[t].interests.length>0}addParticipant(){this.participants.push({childAge:3,childGender:null,interests:[]})}removeParticipant(t){this.participants.length>1&&this.participants.splice(t,1)}areAllParticipantsValid(){return this.participants.every(t=>t.interests.length>0)}onSubmit(){this.submitted=!0;let t=this.participants.every(e=>e.interests.length>0);if(this.checkInForm.valid&&t){let e=this.checkInForm.value,n=this.calculateScheduledTime(),i={playgroundId:this.data.playground.id,parentName:e.parentName?.trim()||"Anonyymi",scheduledTime:n,duration:this.selectedDuration,participants:this.participants.map(c=>({childAge:c.childAge,childGender:c.childGender,interests:c.interests})),additionalInfo:e.additionalInfo||void 0};this.checkInService.createCheckIn(i).subscribe(c=>{this.dialogRef.close(c)})}}calculateScheduledTime(){let t=this.checkInForm.value.scheduledTime,e=new Date;if(this.selectedDate==="tomorrow"&&e.setDate(e.getDate()+1),t==="now")return this.roundToNearest15Minutes(new Date);let[n,i]=t.split(":").map(c=>parseInt(c,10));return e.setHours(n,i,0,0),e}onCancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||a)(x(A),x($),x(ie),x(z))};static \u0275cmp=P({type:a,selectors:[["app-check-in-dialog"]],decls:37,vars:7,consts:[["mat-dialog-title",""],[1,"check-in-form",3,"formGroup"],[1,"form-fieldset"],[1,"fieldset-legend"],["appearance","outline","floatLabel","always",1,"full-width"],["matInput","","formControlName","parentName","placeholder","Voit j\xE4tt\xE4\xE4 tyhj\xE4ksi"],[1,"form-section"],[1,"section-label"],[1,"chip-row"],["type","button","class","selection-chip",3,"selected","click",4,"ngFor","ngForOf"],["appearance","outline",1,"full-width"],["formControlName","scheduledTime"],[3,"value",4,"ngFor","ngForOf"],["type","button","class","selection-chip duration-chip",3,"selected","click",4,"ngFor","ngForOf"],["matInput","","formControlName","additionalInfo","rows","3","placeholder","Esim. kuinka kauan oleskelette, mit\xE4 v\xE4lineit\xE4 otatte mukaan, jne."],["class","form-fieldset",4,"ngFor","ngForOf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["type","button",1,"selection-chip",3,"click"],[3,"value"],["type","button",1,"selection-chip","duration-chip",3,"click"],["type","button","class","remove-participant-btn",3,"click",4,"ngIf"],["type","button","class","selection-chip age-chip",3,"selected","click",4,"ngFor","ngForOf"],["type","button","class","selection-chip gender-chip",3,"selected","click",4,"ngFor","ngForOf"],["type","button","class","remove-selection-btn",3,"click",4,"ngIf"],[1,"interests-grid"],["type","button","class","interest-chip",3,"selected","click",4,"ngFor","ngForOf"],["class","error-message",4,"ngIf"],["type","button","class","add-participant-btn",3,"click",4,"ngIf"],["type","button",1,"remove-participant-btn",3,"click"],["type","button",1,"selection-chip","age-chip",3,"click"],["type","button",1,"selection-chip","gender-chip",3,"click"],[1,"icon"],[1,"label"],["type","button",1,"remove-selection-btn",3,"click"],["type","button",1,"interest-chip",3,"click"],[1,"error-message"],["type","button",1,"add-participant-btn",3,"click"]],template:function(e,n){e&1&&(r(0,"h2",0),l(1,"\u{1F388} Leikkim\xE4\xE4n! \u{1F388}"),o(),r(2,"mat-dialog-content")(3,"form",1)(4,"fieldset",2)(5,"legend",3),l(6),o(),r(7,"mat-form-field",4)(8,"mat-label"),l(9,"Nimi (valinnainen)"),o(),O(10,"input",5),o(),r(11,"div",6)(12,"label",7),l(13,"P\xE4iv\xE4m\xE4\xE4r\xE4"),o(),r(14,"div",8),p(15,le,2,3,"button",9),o()(),r(16,"div",6)(17,"label",7),l(18,"Kellonaika"),o(),r(19,"mat-form-field",10)(20,"mat-select",11),p(21,ce,2,2,"mat-option",12),o()()(),r(22,"div",6)(23,"label",7),l(24,"Kesto"),o(),r(25,"div",8),p(26,se,2,3,"button",13),o()(),r(27,"mat-form-field",10)(28,"mat-label"),l(29,"Lis\xE4tiedot (valinnainen)"),o(),O(30,"textarea",14),o()(),p(31,he,22,8,"fieldset",15),o()(),r(32,"mat-dialog-actions",16)(33,"button",17),u("click",function(){return n.onCancel()}),l(34,"Peruuta"),o(),r(35,"button",18),u("click",function(){return n.onSubmit()}),l(36," Leikkim\xE4\xE4n! "),o()()),e&2&&(s(3),m("formGroup",n.checkInForm),s(3),k(n.data.playground.name),s(9),m("ngForOf",n.dateOptions),s(6),m("ngForOf",n.timeOptions),s(5),m("ngForOf",n.durationOptions),s(5),m("ngForOf",n.participants),s(4),m("disabled",!n.checkInForm.valid||!n.areAllParticipantsValid()))},dependencies:[D,I,y,G,F,w,S,T,V,N,H,L,j,R,Y,K,B,J,U,W,Q,q,Z,X,ee,te,ne],styles:[".check-in-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;padding:1rem 0;width:100%;box-sizing:border-box}@media (max-width: 768px){.check-in-form[_ngcontent-%COMP%]{gap:1rem;padding:.5rem 0}}.form-fieldset[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;padding:1.5rem;margin:0;display:flex;flex-direction:column;gap:1.25rem;position:relative}.form-fieldset[_ngcontent-%COMP%]   .fieldset-legend[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#4caf50;padding:0 .5rem;margin-bottom:0;display:flex;align-items:center;gap:.75rem}.form-fieldset[_ngcontent-%COMP%]   .remove-participant-btn[_ngcontent-%COMP%]{background:#f44336;color:#fff;border:none;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:.9rem;transition:all .2s ease;padding:0;line-height:1}.form-fieldset[_ngcontent-%COMP%]   .remove-participant-btn[_ngcontent-%COMP%]:hover{background:#d32f2f;transform:scale(1.1)}.form-fieldset[_ngcontent-%COMP%]   .add-participant-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:2px dashed #4CAF50;background:#fff;border-radius:8px;cursor:pointer;font-size:.95rem;font-weight:500;color:#4caf50;transition:all .2s ease;width:100%}.form-fieldset[_ngcontent-%COMP%]   .add-participant-btn[_ngcontent-%COMP%]:hover{background:#f1f8f4;border-style:solid;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{display:block;font-size:.9rem;font-weight:500;color:#666;margin-bottom:.75rem}.form-section[_ngcontent-%COMP%]   .chip-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.form-section[_ngcontent-%COMP%]   .selection-chip[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border:2px solid #e0e0e0;background:#fff;border-radius:24px;cursor:pointer;font-size:.95rem;font-weight:500;transition:all .2s ease;color:#333}.form-section[_ngcontent-%COMP%]   .selection-chip[_ngcontent-%COMP%]:hover{border-color:#4caf50;background:#f1f8f4;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .selection-chip.selected[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border-color:#4caf50;box-shadow:0 2px 4px #4caf504d}.form-section[_ngcontent-%COMP%]   .selection-chip.age-chip[_ngcontent-%COMP%]{min-width:50px;padding:.6rem .8rem}.form-section[_ngcontent-%COMP%]   .selection-chip.gender-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.form-section[_ngcontent-%COMP%]   .selection-chip.gender-chip[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.3rem}.form-section[_ngcontent-%COMP%]   .selection-chip.gender-chip[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.9rem}.form-section[_ngcontent-%COMP%]   .remove-selection-btn[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border:2px solid #f44336;background:#fff;border-radius:24px;cursor:pointer;font-size:.9rem;color:#f44336;transition:all .2s ease}.form-section[_ngcontent-%COMP%]   .remove-selection-btn[_ngcontent-%COMP%]:hover{background:#ffebee;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .interests-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:.5rem}.form-section[_ngcontent-%COMP%]   .interest-chip[_ngcontent-%COMP%]{padding:.6rem 1rem;border:2px solid #e0e0e0;background:#fff;border-radius:20px;cursor:pointer;font-size:.9rem;transition:all .2s ease;text-align:center}.form-section[_ngcontent-%COMP%]   .interest-chip[_ngcontent-%COMP%]:hover{border-color:#4caf50;background:#f1f8f4;transform:translateY(-1px)}.form-section[_ngcontent-%COMP%]   .interest-chip.selected[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border-color:#4caf50}.form-section[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#f44336;font-size:.75rem;margin-top:.5rem}mat-form-field[_ngcontent-%COMP%]{width:100%;margin:0}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{background-color:#fff}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-select-value{color:#333;z-index:1;position:relative}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-select-trigger{background-color:#fff}mat-form-field[_ngcontent-%COMP%]     textarea.mat-mdc-input-element{resize:none;z-index:1;position:relative;background-color:#fff}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-input-element{background-color:#fff;color:#333;z-index:2;position:relative}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-input-element::placeholder{opacity:1;color:#0009}mat-form-field[_ngcontent-%COMP%]     input.mat-mdc-input-element{pointer-events:auto;cursor:text}mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline{background-color:#fff}mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__leading, mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__notch, mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__trailing{background-color:#fff}.full-width[_ngcontent-%COMP%]{width:100%}mat-dialog-actions[_ngcontent-%COMP%]{padding:1rem 0 0}[_nghost-%COMP%]     .mat-mdc-dialog-container{--mdc-dialog-container-shape: 16px;box-sizing:border-box}[_nghost-%COMP%]     .mat-mdc-dialog-surface{overflow-y:auto!important;overflow-x:hidden!important;display:flex!important;flex-direction:column!important;box-sizing:border-box;max-height:95vh}@media (max-width: 768px){[_nghost-%COMP%]     .mat-mdc-dialog-surface{max-height:100vh;border-radius:0}}[_nghost-%COMP%]     .mat-mdc-dialog-title{padding:20px 24px 16px;margin:0;flex-shrink:0}@media (max-width: 768px){[_nghost-%COMP%]     .mat-mdc-dialog-title{padding:16px 16px 12px;font-size:1.25rem}}[_nghost-%COMP%]     .mat-mdc-dialog-content{flex:1 1 auto;overflow-y:auto!important;overflow-x:hidden!important;padding:0 24px!important;margin:0;max-height:none!important;-webkit-overflow-scrolling:touch}@media (max-width: 768px){[_nghost-%COMP%]     .mat-mdc-dialog-content{padding:0 16px!important}}[_nghost-%COMP%]     .mat-mdc-dialog-actions{padding:16px 24px 20px;margin:0;flex-shrink:0;border-top:1px solid #e0e0e0}@media (max-width: 768px){[_nghost-%COMP%]     .mat-mdc-dialog-actions{padding:12px 16px 16px}[_nghost-%COMP%]     .mat-mdc-dialog-actions button{flex:1}}[_nghost-%COMP%]     .mat-mdc-dialog-content .mdc-dialog__content{padding:0}"]})};export{oe as a};
